\documentclass[fleqn]{article}
\usepackage[nodisplayskipstretch]{setspace}
\usepackage{amsmath, nccmath}
\usepackage{amssymb}
\usepackage{enumitem}
\usepackage{etoolbox}

\newcommand{\zerodisplayskip}{
	\setlength{\abovedisplayskip}{0pt}%
	\setlength{\belowdisplayskip}{0pt}%
	\setlength{\abovedisplayshortskip}{0pt}%
	\setlength{\belowdisplayshortskip}{0pt}%
	\setlength{\mathindent}{0pt}}

\makeatletter
	\newenvironment{equationCenter}{\@fleqnfalse\begin{equation*}}{\end{equation*}}
\makeatother

\title{Homework 3}
\author{Owen Sowatzke}
\date{September 28, 2023}

\begin{document}
	\offinterlineskip
	\setlength{\lineskip}{12pt}
	\zerodisplayskip
	\maketitle
	
	\begin{enumerate}[nolistsep]
		\item Consider an LTI system with the following frequency response:
		
		\begin{equationCenter}
			H(e^{j\omega}) = \frac{1}{1 - 0.9e^{-j\omega}}
		\end{equationCenter}
		
		Derive the output $y(n)$, corresponding to each of the following inputs:
		
		\begin{enumerate}[nolistsep]	
			\item $x(n) = 1.2\text{cos}(0.2{\pi}n - 0.1)\ \forall\ n$
				
				$y(n) = 1.2|H(e^{j0.2\pi})|\text{cos}(0.2{\pi}n - 0.1 + \angle{H(e^{j0.2\pi}}))$
				
				\begin{equation*}
					H(e^{j0.2\pi}) = \frac{1}{1-0.9e^{-j0.2\pi}} = 1.6813e^{-j1.0960}
				\end{equation*}
				
				$\Rightarrow y(n) = 1.2(1.6813)\text{cos}(0.2{\pi}n - 0.1 + (-1.0960)))$
				
				$\mathbf{= 2.0176\text{\textbf{cos}}(0.2{\pi}n - 1.1960)}$
				
			\item $x(n) = 0.2\text{sin}(0.4{\pi}n) + 0.5\text{cos}(0.6{\pi}n)\ \forall\ n$
			
				$y(n) = 0.2|H(e^{j0.4\pi})|\text{sin}(0.4{\pi}n + \angle{H(e^{j0.4\pi}}))$
				
				$ + 0.5|H(e^{j0.6\pi})|\text{cos}(0.6{\pi}n + \angle{H(e^{j0.6\pi}}))$
				
				\begin{equation*}
					H(e^{j0.4\pi}) = \frac{1}{1-0.9e^{-j0.4\pi}} = 0.8931e^{-j0.8702}
				\end{equation*}
				
				\begin{equation*}
					H(e^{j0.6\pi}) = \frac{1}{1-0.9e^{-j0.6\pi}} = 0.6501e^{-j0.5901}
				\end{equation*}
				
				$\Rightarrow y(n) = 0.2(0.8931)\text{sin}(0.4{\pi}n - 0.8702)$
				
				$ + 0.5(0.6501)\text{cos}(0.6{\pi}n - 0.5901)$
				
				$ \mathbf{= 0.1786\text{\textbf{sin}}(0.4{\pi}n - 0.8702) + 0.3251\text{\textbf{cos}}(0.6{\pi}n - 0.5901)}$
		\end{enumerate}
		\item Derive the Fourier transform of the following signals:
		
			\begin{enumerate}[nolistsep]
				\item $x(n) = 0.5\delta(n) + 0.4\delta(n-1) + 0.1\delta(n-3)$
					\begin{equation*}
						X(e^{j\omega}) = \sum_{n=-\infty}^{\infty}x(n)e^{-j{\omega}n}
					\end{equation*}
					
					\begin{equation*}
						= \sum_{n=-\infty}^{\infty}(0.5\delta(n) + 0.4\delta(n-1) + 0.1\delta(n-3))e^{-j{\omega}n}
					\end{equation*}
					
					\begin{equation*}
						= 0.5\sum_{n=-\infty}^{\infty}\delta(n)e^{-j{\omega}n} + 0.4\sum_{n=-\infty}^{\infty}\delta(n-1)e^{-j{\omega}n}
					\end{equation*}
					
					\begin{equation*}
						 + 0.1\sum_{n=-\infty}^{\infty}\delta(n-3)e^{-j{\omega}n}
					\end{equation*}
					
					\begin{equation*}
						\mathbf{= 0.5 + 0.4e^{-j\omega} + 0.1e^{-j3\omega}}
					\end{equation*}
					
				\item $x(n) = (0.7)^{n}u(n)$
				
					\begin{equation*}
						X(e^{j\omega}) = \sum_{n=-\infty}^{\infty}x(n)e^{-j{\omega}n}
					\end{equation*}
					
					\begin{equation*}
						= \sum_{n=-\infty}^{\infty}(0.7)^{n}u(n)e^{-j{\omega}n}
					\end{equation*}
					
					\begin{equation*}
						= \sum_{n=0}^{\infty}(0.7)^{n}e^{-j{\omega}n}
					\end{equation*}
					
					\begin{equation*}
						= \sum_{n=0}^{\infty}(0.7e^{-j{\omega}})^n
					\end{equation*}
					
					This summation takes the form of
					
					\begin{equation*}
						\sum_{n=0}^{\infty}a^n = \frac{1}{1-a},\quad |a| < 1
					\end{equation*}
					
					\begin{equation*}
						\mathbf{\therefore X(e^{j\omega}) = \frac{1}{1 - 0.7e^{-j\omega}}}
					\end{equation*}
			\end{enumerate}
		
		\pagebreak
		\item Derive the frequency response, $H(e^{j\omega})$, of the LTI system having the following input/output relationship:
		
			$y(n) = -0.4y(n-2)+y(n-3)-0.1x(n+1)+0.8x(n)-0.2x(n-1)$
			
			Start by taking the DTFT of both sides of the equation:
			
			$Y(e^{j\omega}) = -0.4Y(e^{j\omega})e^{-j2\omega}+Y(e^{j\omega})e^{-j3\omega}-0.1X(e^{j\omega})e^{j\omega}$
			
			$+0.8X(e^{j\omega})-0.2X(e^{j\omega})e^{-j\omega}$
			
			Group the $Y(e^{j\omega})$ and $X(e^{j\omega})$ terms on either side of the equation:
			
			$Y(e^{j\omega})(1 + 0.4e^{-j2\omega} - e^{-j3\omega}) = X(e^{j\omega})(-0.1e^{j\omega} + 0.8 - 0.2e^{-j\omega})$
			
			Now solve for $H(e^{j\omega})$:
			
			\begin{equation*}
				\mathbf{H(e^{j\omega}) = \frac{Y(e^{j\omega})}{X(e^{j\omega})} = \frac{-0.1e^{j\omega} + 0.8 - 0.2e^{-j\omega}}{1 + 0.4e^{-j2\omega} - e^{-j3\omega}}}
			\end{equation*}
		\item Write a difference equation that characterizes an LTI system whose frequency response is
		
			\begin{equation*}
				H(e^{j\omega}) = \frac{1 + 0.4e^{-j\omega} - 0.7e^{-j2\omega}}{1 - 0.9e^{-j\omega} + 0.2e^{-j2\omega}}
			\end{equation*}
			
			\begin{equation*}
				\frac{Y(e^{j\omega})}{X(e^{j\omega})} = \frac{1 + 0.4e^{-j\omega} - 0.7e^{-j2\omega}}{1 - 0.9e^{-j\omega} + 0.2e^{-j2\omega}}
			\end{equation*}
			
			$Y(e^{j\omega})(1 - 0.9e^{-j\omega} + 0.2e^{-j2\omega}) = X(e^{j\omega})(1 + 0.4e^{-j\omega} - 0.7e^{-j2\omega})$
			
			$Y(e^{j\omega}) - 0.9Y(e^{j\omega})e^{-j\omega} + 0.2Y(e^{j\omega})e^{-j2\omega} = X(e^{j\omega})$
			
			$ + 0.4X(e^{j\omega})e^{-j\omega} - 0.7X(e^{j\omega})e^{-j2\omega}$
			
			Take the inverse DTFT of both sides of the equation:
			
			$y(n) - 0.9y(n-1) + 0.2y(n-2) = x(n) + 0.4x(n-1) - 0.7x(n-2)$
			
			Rewrite the equation to solve for $y(n)$ with the input and previous values of the output:
			
			$\mathbf{y(n) = 0.9y(n-1) - 0.2y(n-2) + x(n) + 0.4x(n-1) - 0.7x(n-2)}$
			
	\end{enumerate}
\end{document}