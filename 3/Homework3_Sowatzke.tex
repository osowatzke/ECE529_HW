\documentclass[fleqn]{article}
\usepackage[nodisplayskipstretch]{setspace}
\usepackage{amsmath, nccmath}
\usepackage{amssymb}
\usepackage{enumitem}
\usepackage{etoolbox}

\newcommand{\zerodisplayskip}{
	\setlength{\abovedisplayskip}{0pt}%
	\setlength{\belowdisplayskip}{0pt}%
	\setlength{\abovedisplayshortskip}{0pt}%
	\setlength{\belowdisplayshortskip}{0pt}%
	\setlength{\mathindent}{0pt}}

\makeatletter
	\newenvironment{equationCenter}{\@fleqnfalse\begin{equation*}}{\end{equation*}}
\makeatother

\title{Homework 3}
\author{Owen Sowatzke}
\date{September 28, 2023}

\begin{document}
	\offinterlineskip
	\setlength{\lineskip}{12pt}
	\zerodisplayskip
	\maketitle
	
	\begin{enumerate}[nolistsep]
		\item Consider an LTI system with the following frequency response:
		
		\begin{equationCenter}
			H(e^{j\omega}) = \frac{1}{1 - 0.9e^{-j\omega}}
		\end{equationCenter}
		
		Derive the output $y(n)$, corresponding to each of the following inputs:
		
		\begin{enumerate}[nolistsep]	
			\item $x(n) = 1.2\text{cos}(0.2{\pi}n - 0.1)\ \forall\ n$
				
				$y(n) = 1.2|H(e^{j0.2\pi})|\text{cos}(0.2{\pi}n - 0.1 + \angle{H(e^{j0.2\pi}}))$
				
				\begin{equation*}
					H(e^{j0.2\pi}) = \frac{1}{1-0.9e^{-j0.2\pi}} = 1.6813e^{-j1.0960}
				\end{equation*}
				
				$\Rightarrow y(n) = 1.2(1.6813)\text{cos}(0.2{\pi}n - 0.1 + (-1.0960)))$
				
				$\mathbf{= 2.0176\text{\textbf{cos}}(0.2{\pi}n - 1.1960)}$
				
			\item $x(n) = 0.2\text{sin}(0.4{\pi}n) + 0.5\text{cos}(0.6{\pi}n)\ \forall\ n$
			
				$y(n) = 0.2|H(e^{j0.4\pi})|\text{sin}(0.4{\pi}n + \angle{H(e^{j0.4\pi}}))$
				
				$ + 0.5|H(e^{j0.6\pi})|\text{cos}(0.6{\pi}n + \angle{H(e^{j0.6\pi}}))$
				
				\begin{equation*}
					H(e^{j0.4\pi}) = \frac{1}{1-0.9e^{-j0.4\pi}} = 0.8931e^{-j0.8702}
				\end{equation*}
				
				\begin{equation*}
					H(e^{j0.6\pi}) = \frac{1}{1-0.9e^{-j0.6\pi}} = 0.6501e^{-j0.5901}
				\end{equation*}
				
				$\Rightarrow y(n) = 0.2(0.8931)\text{sin}(0.4{\pi}n - 0.8702)$
				
				$ + 0.5(0.6501)\text{cos}(0.6{\pi}n - 0.5901)$
				
				$ \mathbf{= 0.1786\text{\textbf{sin}}(0.4{\pi}n - 0.8702) + 0.3251\text{\textbf{cos}}(0.6{\pi}n - 0.5901)}$
		\end{enumerate}
		\item Derive the Fourier transform of the following signals:
		
			\begin{enumerate}[nolistsep]
				\item $x(n) = 0.5\delta(n) + 0.4\delta(n-1) + 0.1\delta(n-3)$
					\begin{equation*}
						X(e^{j\omega}) = \sum_{n=-\infty}^{\infty}x(n)e^{-j{\omega}n}
					\end{equation*}
					
					\begin{equation*}
						= \sum_{n=-\infty}^{\infty}(0.5\delta(n) + 0.4\delta(n-1) + 0.1\delta(n-3))e^{-j{\omega}n}
					\end{equation*}
					
					\begin{equation*}
						= 0.5\sum_{n=-\infty}^{\infty}\delta(n)e^{-j{\omega}n} + 0.4\sum_{n=-\infty}^{\infty}\delta(n-1)e^{-j{\omega}n}
					\end{equation*}
					
					\begin{equation*}
						 + 0.1\sum_{n=-\infty}^{\infty}\delta(n-3)e^{-j{\omega}n}
					\end{equation*}
					
					\begin{equation*}
						\mathbf{= 0.5 + 0.4e^{-j\omega} + 0.1e^{-j3\omega}}
					\end{equation*}
					 
				\item $x(n) = (0.7)^{n}u(n)$
				
					\begin{equation*}
						X(e^{j\omega}) = \sum_{n=-\infty}^{\infty}x(n)e^{-j{\omega}n} = \sum_{n=-\infty}^{\infty}(0.7)^{n}u(n)e^{-j{\omega}n}
					\end{equation*}
					
					\begin{equation*}
						= \sum_{n=0}^{\infty}(0.7)^{n}e^{-j{\omega}n} = \sum_{n=0}^{\infty}(0.7e^{-j{\omega}})^n
					\end{equation*}
					
					This summation takes the form of
					
					\begin{equation*}
						\sum_{n=0}^{\infty}a^n = \frac{1}{1-a},\quad |a| < 1
					\end{equation*}
					
					\begin{equation*}
						\mathbf{\therefore X(e^{j\omega}) = \frac{1}{1 - 0.7e^{-j\omega}}}
					\end{equation*}
			\end{enumerate}
		
		\item Derive the frequency response, $H(e^{j\omega})$, of the LTI system having the following input/output relationship:
		
			$y(n) = -0.4y(n-2)+y(n-3)-0.1x(n+1)+0.8x(n)-0.2x(n-1)$
			
			\pagebreak
			Start by taking the DTFT of both sides of the equation:
			
			$Y(e^{j\omega}) = -0.4Y(e^{j\omega})e^{-j2\omega}+Y(e^{j\omega})e^{-j3\omega}-0.1X(e^{j\omega})e^{j\omega}$
			
			$+0.8X(e^{j\omega})-0.2X(e^{j\omega})e^{-j\omega}$
			
			Group the $Y(e^{j\omega})$ and $X(e^{j\omega})$ terms on either side of the equation:
			
			$Y(e^{j\omega})(1 + 0.4e^{-j2\omega} - e^{-j3\omega}) = X(e^{j\omega})(-0.1e^{j\omega} + 0.8 - 0.2e^{-j\omega})$
			
			Now solve for $H(e^{j\omega})$:
			
			\begin{equation*}
				\mathbf{H(e^{j\omega}) = \frac{Y(e^{j\omega})}{X(e^{j\omega})} = \frac{-0.1e^{j\omega} + 0.8 - 0.2e^{-j\omega}}{1 + 0.4e^{-j2\omega} - e^{-j3\omega}}}
			\end{equation*}
		\item Write a difference equation that characterizes an LTI system whose frequency response is
		
			\begin{equation*}
				H(e^{j\omega}) = \frac{1 + 0.4e^{-j\omega} - 0.7e^{-j2\omega}}{1 - 0.9e^{-j\omega} + 0.2e^{-j2\omega}}
			\end{equation*}
			
			\begin{equation*}
				\frac{Y(e^{j\omega})}{X(e^{j\omega})} = \frac{1 + 0.4e^{-j\omega} - 0.7e^{-j2\omega}}{1 - 0.9e^{-j\omega} + 0.2e^{-j2\omega}}
			\end{equation*}
			
			$Y(e^{j\omega})(1 - 0.9e^{-j\omega} + 0.2e^{-j2\omega}) = X(e^{j\omega})(1 + 0.4e^{-j\omega} - 0.7e^{-j2\omega})$
			
			$Y(e^{j\omega}) - 0.9Y(e^{j\omega})e^{-j\omega} + 0.2Y(e^{j\omega})e^{-j2\omega} = X(e^{j\omega})$
			
			$ + 0.4X(e^{j\omega})e^{-j\omega} - 0.7X(e^{j\omega})e^{-j2\omega}$
			
			Take the inverse DTFT of both sides of the equation:
			
			$y(n) - 0.9y(n-1) + 0.2y(n-2) = x(n) + 0.4x(n-1) - 0.7x(n-2)$
			
			Rewrite the equation to solve for $y(n)$ with the input and previous values of the output:
			
			$\mathbf{y(n) = 0.9y(n-1) - 0.2y(n-2) + x(n) + 0.4x(n-1) - 0.7x(n-2)}$
			
		\item Derive the z-transform and region of convergence of the following signals:
		
			\begin{enumerate}[nolistsep]
				\item $x(n) = 0.2\delta(n+1) + 0.9\delta(n) + 0.3\delta(n-1)$
				
					\pagebreak
					\begin{equation*}
						X(z) = \sum_{n=-\infty}^{\infty}x(n)z^{-n}
					\end{equation*}
					
					\begin{equation*}
						= \sum_{n=-\infty}^{\infty}(0.2\delta(n+1) + 0.9\delta(n) + 0.3\delta(n-1))z^{-n}
					\end{equation*}
					
					\begin{equation*}
						= 0.2\sum_{n=-\infty}^{\infty}\delta(n+1)z^{-n} + 0.9\sum_{n=-\infty}^{\infty}\delta(n)z^{-n} + 0.3\sum_{n=-\infty}^{\infty}\delta(n-1)z^{-n}
					\end{equation*}
					
					$\mathbf{X(z) = 0.2z + 0.9 + 0.3z^{-1}}$
					
					\textbf{ROC : All $\mathbf{z}$ except $\mathbf{z = 0}$ or $\mathbf{z = \infty}$}
					
				\item $x(n) = \left(\frac{1}{3}\right)^{n}u(n)$
				
					\begin{equation*}
						X(z) = \sum_{n=-\infty}^{\infty}x(n)z^{-n} = \sum_{n=-\infty}^{\infty}\left(\frac{1}{3}\right)^{n}u(n)z^{-n}
					\end{equation*}
					
					\begin{equation*}
						= \sum_{n=0}^{\infty}\left(\frac{1}{3}\right)^{n}z^{-n} = \sum_{n=0}^{\infty}\left(\left(\frac{1}{3}\right)z^{-1}\right)^{n}
					\end{equation*}
					
					Summation converges if
					
					$\left|\left(\frac{1}{3}\right)z^{-1}\right| < 1 \Rightarrow |z^{-1}| < 3 \Rightarrow |z| > \frac{1}{3}$
					
					\begin{equation*}
						\mathbf{\therefore X(z) = \frac{1}{1 - \frac{1}{3}z^{-1}} \quad \text{\textbf{ROC: }} |z| > \frac{1}{3}}
					\end{equation*}
					
				\item $x(n) = 4^{n}u(-n)$
				
					\begin{equation*}
						X(z) = \sum_{n=-\infty}^{\infty}x(n)z^{-n} = \sum_{n=-\infty}^{\infty}x(n)z^{-n}
					\end{equation*}
					
					\begin{equation*}
						 = \sum_{n=-\infty}^{\infty}4^{n}u(-n)z^{-n} = \sum_{n=-\infty}^{0}4^{n}z^{-n}
					\end{equation*}
					
					Let $m = -n$
					
					\begin{equation*}
						\Rightarrow X(z) = \sum_{m=0}^{\infty}4^{-m}z^{m} = \sum_{m=0}^{\infty}(4^{-1}z)^{m} = \sum_{m=0}^{\infty}\left(\left(\frac{1}{4}\right)z\right)^{m}
					\end{equation*}
					
					\pagebreak
					Summation converges if
					
					$\left|\left(\frac{1}{4}\right)z\right| < 1 \Rightarrow |z| < 4$
					
					When the summation converges:
					
					\begin{equation*}
						X(z) = \frac{1}{1 - \frac{1}{4}z} = \frac{4}{4 - z} = \frac{4z^{-1}}{4z^{-1} - 1}
					\end{equation*}
					
					\begin{equation*}
						\mathbf{\therefore X(z) = -\frac{4z^{-1}}{1 - 4z^{-1}} \quad \text{\textbf{ROC: }} |z| < 4}
					\end{equation*}
				\item $x(n) = \left(\frac{1}{2}\right)^{n+1}u(n-3)$
				
					\begin{equation*}
						X(z) = \sum_{n=-\infty}^{\infty}x(n)z^{-n} = \sum_{n=-\infty}^{\infty}\left(\frac{1}{2}\right)^{n+1}u(n-3)z^{-n} =  \sum_{n=3}^{\infty}\left(\frac{1}{2}\right)^{n+1}z^{-n}
					\end{equation*}
					
					Let $m = n - 3$
					
					\begin{equation*}
						\Rightarrow X(z) = \sum_{m=0}^{\infty}\left(\frac{1}{2}\right)^{m+4}z^{-(m+3)} = \left(\frac{1}{2}\right)^{4}z^{-3}\sum_{m=0}^{\infty}\left(\frac{1}{2}\right)^{m}z^{-m}
					\end{equation*}
					
					\begin{equation*}
						 = \left(\frac{1}{2}\right)^{4}z^{-3}\sum_{m=0}^{\infty}\left(\left(\frac{1}{2}\right)z^{-1}\right)^{m}
					\end{equation*}
					
					Summation converges if
					
					$\left|\left(\frac{1}{2}\right)z^{-1}\right| < 1 \Rightarrow |z^{-1}| < 2 \Rightarrow |z| > \frac{1}{2}$
					
					When the summation converges:
					
					\begin{equation*}
						X(z) = \left(\frac{1}{2}\right)^{4}\frac{z^{-3}}{1 - \frac{1}{2}z^{-1}} = \frac{z^{-3}}{2^{4}(1 - \frac{1}{2}z^{-1})} = \frac{z^{-3}}{2^{3}(2 - z^{-1})}
					\end{equation*}
					
					Note that the additional $z^{-n}$ terms in the $X(z)$ expression will add additional poles at $z = 0$. However, these poles will not change the ROC, because $z = 0$ is outside of the ROC implied by the summation. 
					
					\begin{equation*}
						\mathbf{\therefore X(z) = \frac{z^{-3}}{2^{3}(2 - z^{-1})} \quad \text{\textbf{ROC: }} |z| > \frac{1}{2}}
					\end{equation*}
			\end{enumerate}
	\end{enumerate}
\end{document}